import{a as J}from"./chunk-GHDWACS7.js";import{a as I,b as Q}from"./chunk-JNMNL4QL.js";import{D as z,H as U,K as V,Q as G,S as O,hb as K,v as q,w as v,x as D,y as L}from"./chunk-5KVTLUS6.js";import{a as y,c as H}from"./chunk-3VSYNEYF.js";import{B as S,C as B,E as P,d as M,f as b,m as j,y as A,z as N}from"./chunk-3N5DGQTQ.js";import{$b as g,Bb as c,Dc as x,M as C,Nb as o,Xb as p,Yb as l,Zb as h,_b as f,da as R,gc as T,hc as d,ib as n,nb as s,tc as a,vb as _,vc as w,wb as F}from"./chunk-5HLPFG4U.js";import"./chunk-GAL4ENT6.js";var k=e=>({"is-invalid":e});function re(e,m){if(e&1&&(p(0,"div",11),a(1),l()),e&2){let t=d();n(),w(" ",t.formErrorMessage," ")}}function ne(e,m){e&1&&(f(0),a(1," Username should be at least 4 characters long. "),g())}function oe(e,m){if(e&1&&(f(0),a(1),g()),e&2){let t=d(2);n(),w(" ",t.username.errors.serverError," ")}}function ae(e,m){if(e&1&&(p(0,"div",12),c(1,ne,2,0,"ng-container",13)(2,oe,2,1,"ng-container",13),l()),e&2){let t=d();n(),o("ngIf",t.username.errors.minlength),n(),o("ngIf",t.username.errors.serverError)}}function se(e,m){e&1&&(f(0),a(1," Please enter a correct email. "),g())}function me(e,m){if(e&1&&(f(0),a(1),g()),e&2){let t=d(2);n(),w(" ",t.email.errors.serverError," ")}}function ce(e,m){if(e&1&&(p(0,"div",12),c(1,se,2,0,"ng-container",13)(2,me,2,1,"ng-container",13),l()),e&2){let t=d();n(),o("ngIf",t.email.errors.email),n(),o("ngIf",t.email.errors.serverError)}}function pe(e,m){e&1&&(f(0),a(1," Password should at least have 3 characters. "),g())}function le(e,m){if(e&1&&(f(0),a(1),g()),e&2){let t=d(2);n(),w(" ",t.password.errors.serverError," ")}}function de(e,m){if(e&1&&(p(0,"div",12),c(1,pe,2,0,"ng-container",13)(2,le,2,1,"ng-container",13),l()),e&2){let t=d();n(),o("ngIf",t.password.errors.minlength),n(),o("ngIf",t.password.errors.serverError)}}function ue(e,m){e&1&&h(0,"span",14)}var X=(()=>{class e{fb;authHttpService;router;snackBar;recaptchaService;signupForm;formErrorMessage;loading=!1;environment=A;subscribers=[];constructor(t,r,i,u,E){this.fb=t,this.authHttpService=r,this.router=i,this.snackBar=u,this.recaptchaService=E,this.subscribers.push(this.recaptchaService.resolved.subscribe(Z=>{this.registerUser(Z)}))}ngAfterViewInit(){this.recaptchaService.render()}ngOnInit(){this.signupForm=this.fb.group({username:["",[v.required.bind(this),v.minLength(4)]],email:["",[v.required.bind(this),v.email.bind(this)]],password:["",[v.required.bind(this),v.minLength(3)]]})}ngOnDestroy(){this.subscribers.forEach(t=>t.unsubscribe())}registerUser(t){this.loading=!0,this.authHttpService.register(this.signupForm.value,t).pipe(C(()=>this.loading=!1)).subscribe({next:()=>{this.signupForm.reset(),this.snackBar.open("Account created! Please check your emails to activate your account",void 0,{horizontalPosition:"end",verticalPosition:"bottom",panelClass:"success",duration:1e4}),this.router.navigate(["/"])},error:r=>{r=r.error,Array.isArray(r.message)?r.message.map(i=>{if(typeof i!="string"){let u=this.signupForm.get(i.property);u?.markAsTouched(),u?.setErrors({serverError:i.errors})}}):this.formErrorMessage=r.message,this.recaptchaService.reset()}})}get username(){return this.signupForm.get("username")}get email(){return this.signupForm.get("email")}get password(){return this.signupForm.get("password")}static \u0275fac=function(r){return new(r||e)(s(O),s(y),s(S),s(I),s(J))};static \u0275cmp=_({type:e,selectors:[["app-register"]],standalone:!1,decls:16,vars:16,consts:[[1,"tw-flex","tw-items-center","tw-justify-center","tw-flex-col",3,"ngSubmit","formGroup"],["class","col-md-12 alert alert-danger","role","alert",4,"ngIf"],["type","text","formControlName","username","placeholder","Username","required","",1,"form-control","!tw-bg-grey","tw-text-center","tw-w-[300px]","md:tw-w-[400px]","tw-h-[53px]","tw-mt-8","tw-mb-2","tw-rounded-md","placeholder:tw-text-white",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["type","email","formControlName","email","placeholder","Email","required","",1,"form-control","!tw-bg-grey","tw-text-center","tw-w-[300px]","md:tw-w-[400px]","tw-h-[53px]","tw-mb-2","tw-rounded-md","placeholder:tw-text-white",3,"ngClass"],["type","password","formControlName","password","placeholder","Password","required","",1,"form-control","!tw-bg-grey","tw-text-center","tw-w-[300px]","md:tw-w-[400px]","tw-h-[53px]","tw-rounded-md","placeholder:tw-text-white",3,"ngClass"],["id","g-recaptcha"],["type","submit",1,"tw-h-btn","tw-w-btn","tw-bg-lime","tw-mt-6","tw-text-black",3,"disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],[1,"tw-text-white","tw-text-sm","!tw-mt-5"],["routerLink","/",1,"tw-text-[#59EE7F]","tw-no-underline"],["role","alert",1,"col-md-12","alert","alert-danger"],[1,"invalid-feedback"],[4,"ngIf"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(r,i){r&1&&(p(0,"form",0),T("ngSubmit",function(){return i.loading||i.recaptchaService.execute()}),c(1,re,2,1,"div",1),h(2,"input",2),c(3,ae,3,2,"div",3),h(4,"input",4),c(5,ce,3,2,"div",3),h(6,"input",5),c(7,de,3,2,"div",3),h(8,"div",6),p(9,"button",7),a(10," Sign Up "),c(11,ue,1,0,"span",8),l(),p(12,"p",9),a(13," Already have an account ? "),p(14,"a",10),a(15,"Login"),l()()()),r&2&&(o("formGroup",i.signupForm),n(),o("ngIf",i.formErrorMessage),n(),o("ngClass",x(10,k,i.username.invalid&&(i.username.dirty||i.username.touched))),n(),o("ngIf",i.username.errors),n(),o("ngClass",x(12,k,i.email.invalid&&(i.email.dirty||i.email.touched))),n(),o("ngIf",i.email.errors),n(),o("ngClass",x(14,k,i.password.invalid&&(i.password.dirty||i.password.touched))),n(),o("ngIf",i.password.errors),n(2),o("disabled",i.signupForm.invalid||i.loading),n(2),o("ngIf",i.loading))},dependencies:[M,b,z,q,D,L,G,U,V,B],encapsulation:2})}return e})();function fe(e,m){e&1&&(p(0,"div",1)(1,"div",2)(2,"span",3),a(3,"Loading..."),l()()())}var Y=(()=>{class e{authHttpService;authService;route;router;snackBar;loading=!1;constructor(t,r,i,u,E){this.authHttpService=t,this.authService=r,this.route=i,this.router=u,this.snackBar=E}ngOnInit(){this.loading=!0,this.route.paramMap.subscribe(t=>{this.authHttpService.confirm(t.get("token")).pipe(C(()=>this.loading=!1)).subscribe({next:r=>{this.authService.setAccessTokenCookie(r.accessToken),this.authService.setRefreshTokenCookie(r.refreshToken),this.snackBar.open("Account activated!",void 0,{horizontalPosition:"end",verticalPosition:"bottom",panelClass:"success",duration:5e3})},error:r=>{r.status===400&&this.snackBar.open("account already activated",void 0,{horizontalPosition:"end",verticalPosition:"bottom",panelClass:"danger",duration:5e3}),this.router.navigate(["/"])}})})}static \u0275fac=function(r){return new(r||e)(s(y),s(H),s(N),s(S),s(I))};static \u0275cmp=_({type:e,selectors:[["app-confirmation"]],standalone:!1,decls:1,vars:1,consts:[["class","d-flex justify-content-center",4,"ngIf"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"]],template:function(r,i){r&1&&c(0,fe,4,0,"div",0),r&2&&o("ngIf",i.loading)},dependencies:[b],encapsulation:2})}return e})();var ge=[{path:"",component:X},{path:":token",component:Y}],Me=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=F({type:e});static \u0275inj=R({imports:[j,K,P.forChild(ge),Q]})}return e})();export{Me as RegisterModule};
