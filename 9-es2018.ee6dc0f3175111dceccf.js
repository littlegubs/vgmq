(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{BXcl:function(t,i,e){"use strict";e.r(i),e.d(i,"GameModule",(function(){return Z}));var s=e("ofXK");class c{constructor(t){Object.assign(this,t)}}class n{constructor(t){Object.assign(this,t)}}class r{constructor(t){this.id=t.id,this.title=t.title,this.artist=t.artist,this.duration=t.duration,this.durationDate=new Date(0,0,0,0,0,this.duration),this.guessAccuracy=t.guessAccuracy,this.playNumber=t.playNumber}}class a{constructor(t){this.title=t.title,this.artist=t.artist}}class o{constructor(t){this.id=t.id,this.music=new r(t.music)}}class u{constructor(t){var i,e;this.id=t.id,this.firstReleaseDate=t.firstReleaseDate,this.name=t.name,this.slug=t.slug,this.alternativeNames=null===(i=t.alternativeNames)||void 0===i?void 0:i.map(t=>new n(t)),this.gameMusics=null===(e=t.gameMusics)||void 0===e?void 0:e.map(t=>new o(t)),this.cover=new c(t.cover)}}class b{constructor(t){this.errors=[],this.errors=t.errors}}var l=e("nYR2"),d=e("fXoL"),m=e("z6cu"),h=e("AytR"),p=e("JIr8"),g=e("tk/3");let f=(()=>{class t{constructor(t){this.http=t,this.apiEndpoint=h.a.apiEndpoint}search(t){return this.http.get(`${this.apiEndpoint}/admin/games?query=${t}`)}get(t){return this.http.get(`${this.apiEndpoint}/admin/games/${t}`)}uploadMusics(t,i){const e=new FormData;for(const s of i)e.append("music_files[files][]",s);return this.http.post(`${this.apiEndpoint}/admin/games/${t}/musics/upload`,e).pipe(Object(p.a)(t=>Object(m.a)(new b(t.error))))}saveMusic(t,i){return this.http.patch(`${this.apiEndpoint}/admin/musics/${t.id}`,i).pipe(Object(p.a)(t=>Object(m.a)(new a(t.error.errors))))}deleteGameMusic(t){return this.http.delete(`${this.apiEndpoint}/admin/games-musics/${t.id}`)}}return t.\u0275fac=function(i){return new(i||t)(d.Ub(g.b))},t.\u0275prov=d.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var v=e("3Pt+"),P=e("tyNb");function Q(t,i){1&t&&(d.Ob(0),d.Qb(1,"div",5),d.Qb(2,"div",6),d.Qb(3,"span",7),d.uc(4,"Loading..."),d.Pb(),d.Pb(),d.Pb(),d.Nb())}function M(t,i){if(1&t&&d.Mb(0,"img",15),2&t){const t=d.cc().$implicit;d.ic("src","https://images.igdb.com/igdb/image/upload/t_720p/",t.cover.imageId,".jpg",d.qc)}}const y=function(t){return["/admin/games/",t]};function B(t,i){if(1&t&&(d.Qb(0,"a",10),d.sc(1,M,1,1,"img",11),d.Qb(2,"div",12),d.Qb(3,"h3",13),d.uc(4),d.Pb(),d.Qb(5,"p",14),d.uc(6),d.dc(7,"date"),d.Pb(),d.Pb(),d.Pb()),2&t){const t=i.$implicit;d.hc("routerLink",d.kc(7,y,t.slug)),d.Bb(1),d.hc("ngIf",t.cover.imageId),d.Bb(3),d.vc(t.name),d.Bb(2),d.vc(d.ec(7,4,t.firstReleaseDate,"y"))}}function w(t,i){if(1&t&&(d.Qb(0,"div",8),d.sc(1,B,8,9,"a",9),d.Pb()),2&t){const t=d.cc();d.Bb(1),d.hc("ngForOf",t.games)}}let k=(()=>{class t{constructor(t){this.adminGameHttpService=t,this.games=[],this.query="",this.loading=!1}ngOnInit(){this.search()}search(){this.http&&this.http.unsubscribe(),this.loading=!0,this.http=this.adminGameHttpService.search(this.query).pipe(Object(l.a)(()=>this.loading=!1)).subscribe(t=>{this.games=t.data.map(t=>new u(t))})}}return t.\u0275fac=function(i){return new(i||t)(d.Lb(f))},t.\u0275cmp=d.Fb({type:t,selectors:[["app-game-search"]],decls:7,vars:3,consts:[[1,"form-group"],["for","exampleFormControlInput1"],["type","text","id","exampleFormControlInput1","placeholder","game...",1,"form-control",3,"ngModel","ngModelChange","keyup"],[4,"ngIf","ngIfElse"],["cardColumns",""],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border","orange"],[1,"sr-only"],[1,"card-columns","admin-card-columns"],["class","card","style","width: 18rem;",3,"routerLink",4,"ngFor","ngForOf"],[1,"card",2,"width","18rem",3,"routerLink"],["class","card-img-top","alt","...",3,"src",4,"ngIf"],[1,"card-body"],[1,"card-title","orange"],[1,"card-text"],["alt","...",1,"card-img-top",3,"src"]],template:function(t,i){if(1&t&&(d.Qb(0,"div",0),d.Qb(1,"label",1),d.uc(2,"Search games"),d.Pb(),d.Qb(3,"input",2),d.Yb("ngModelChange",(function(t){return i.query=t}))("keyup",(function(){return i.search()})),d.Pb(),d.Pb(),d.sc(4,Q,5,0,"ng-container",3),d.sc(5,w,2,1,"ng-template",null,4,d.tc)),2&t){const t=d.nc(6);d.Bb(3),d.hc("ngModel",i.query),d.Bb(1),d.hc("ngIf",i.loading)("ngIfElse",t)}},directives:[v.b,v.k,v.m,s.k,s.j,P.e],pipes:[s.d],encapsulation:2}),t})();var I=e("PCNd"),F=e("6NWb");const O=["musicRow",""];function E(t,i){if(1&t&&(d.Ob(0),d.Qb(1,"th",3),d.uc(2),d.Pb(),d.Qb(3,"td"),d.uc(4),d.Pb(),d.Nb()),2&t){const t=d.cc();d.Bb(2),d.vc(t.gameMusic.music.title),d.Bb(2),d.vc(t.gameMusic.music.artist)}}function G(t,i){1&t&&(d.Ob(0),d.uc(1," title cannot be empty "),d.Nb())}function N(t,i){if(1&t&&(d.Ob(0),d.uc(1),d.Nb()),2&t){const t=d.cc(3);d.Bb(1),d.wc(" ",t.title.errors.apiError[0]," ")}}function j(t,i){if(1&t&&(d.Qb(0,"div",8),d.sc(1,G,2,0,"ng-container",9),d.sc(2,N,2,1,"ng-container",9),d.Pb()),2&t){const t=d.cc(2);d.Bb(1),d.hc("ngIf",t.title.errors.required),d.Bb(1),d.hc("ngIf",t.title.errors.apiError)}}const L=function(t){return{"is-invalid":t}};function C(t,i){if(1&t&&(d.Ob(0,4),d.Qb(1,"th",3),d.Mb(2,"input",5),d.sc(3,j,3,2,"div",6),d.Pb(),d.Qb(4,"td"),d.Mb(5,"input",7),d.Pb(),d.Nb()),2&t){const t=d.cc();d.hc("formGroup",t.formGroup),d.Bb(2),d.hc("ngClass",d.kc(3,L,t.title.invalid&&(t.title.dirty||t.title.touched))),d.Bb(1),d.hc("ngIf",t.title.errors)}}function D(t,i){1&t&&(d.Ob(0),d.Qb(1,"div",10),d.Qb(2,"span",11),d.uc(3,"Loading..."),d.Pb(),d.Pb(),d.Nb())}const $=function(){return["fas","pen"]},R=function(){return["fas","times"]};function H(t,i){if(1&t){const t=d.Rb();d.Ob(0),d.Qb(1,"button",13),d.Yb("click",(function(){return d.oc(t),d.cc(2).createFormGroup()})),d.Mb(2,"fa-icon",14),d.Pb(),d.Qb(3,"button",15),d.Yb("click",(function(){return d.oc(t),d.cc(2).delete()})),d.Mb(4,"fa-icon",14),d.Pb(),d.Nb()}2&t&&(d.Bb(2),d.hc("icon",d.jc(2,$)),d.Bb(2),d.hc("icon",d.jc(3,R)))}const x=function(){return["fas","check"]};function S(t,i){if(1&t){const t=d.Rb();d.Qb(0,"button",16),d.Yb("click",(function(){return d.oc(t),d.cc(2).save()})),d.Mb(1,"fa-icon",14),d.Pb(),d.Qb(2,"button",15),d.Yb("click",(function(){return d.oc(t),d.cc(2).cancel()})),d.Mb(3,"fa-icon",14),d.Pb()}2&t&&(d.Bb(1),d.hc("icon",d.jc(2,x)),d.Bb(2),d.hc("icon",d.jc(3,R)))}function q(t,i){if(1&t&&(d.sc(0,H,5,4,"ng-container",0),d.sc(1,S,4,4,"ng-template",null,12,d.tc)),2&t){const t=d.nc(2),i=d.cc();d.hc("ngIf",!i.edit)("ngIfElse",t)}}let Y=(()=>{class t{constructor(t,i){this.formBuilder=t,this.adminGameHttpService=i,this.onDelete=new d.n,this.edit=!1,this.loading=!1}createFormGroup(){this.edit=!0,this.formGroup=new v.f({title:new v.d(this.gameMusic.music.title,v.p.required.bind(this)),artist:new v.d(this.gameMusic.music.artist)})}get title(){return this.formGroup.get("title")}get artist(){return this.formGroup.get("artist")}cancel(){this.edit=!1,this.formGroup.reset()}save(){this.loading=!0,this.adminGameHttpService.saveMusic(this.gameMusic.music,this.formGroup.value).pipe(Object(l.a)(()=>this.loading=!1)).subscribe(t=>{this.gameMusic.music=t,this.edit=!1},t=>{t.title&&this.title.setErrors({apiError:t.title}),t.artist&&this.artist.setErrors({apiError:t.artist})})}delete(){this.loading=!0,this.adminGameHttpService.deleteGameMusic(this.gameMusic).pipe(Object(l.a)(()=>this.loading=!1)).subscribe(()=>{this.onDelete.emit(this.gameMusic)})}}return t.\u0275fac=function(i){return new(i||t)(d.Lb(v.c),d.Lb(f))},t.\u0275cmp=d.Fb({type:t,selectors:[["","musicRow",""]],inputs:{gameMusic:"gameMusic"},outputs:{onDelete:"onDelete"},attrs:O,decls:14,vars:10,consts:[[4,"ngIf","ngIfElse"],["editMusic",""],["musicRowButtons",""],["scope","row"],[3,"formGroup"],["formControlName","title",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["formControlName","artist"],[1,"invalid-feedback"],[4,"ngIf"],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"],["editMusicButtons",""],[1,"btn","btn-sm","btn-primary",3,"click"],[3,"icon"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"btn","btn-sm","btn-success",3,"click"]],template:function(t,i){if(1&t&&(d.sc(0,E,5,2,"ng-container",0),d.sc(1,C,6,5,"ng-template",null,1,d.tc),d.Qb(3,"td"),d.uc(4),d.dc(5,"date"),d.Pb(),d.Qb(6,"td"),d.uc(7),d.Pb(),d.Qb(8,"td"),d.uc(9),d.Pb(),d.Qb(10,"td"),d.sc(11,D,4,0,"ng-container",0),d.sc(12,q,3,2,"ng-template",null,2,d.tc),d.Pb()),2&t){const t=d.nc(2),e=d.nc(13);d.hc("ngIf",!i.edit)("ngIfElse",t),d.Bb(4),d.vc(d.ec(5,7,i.gameMusic.music.durationDate,"HH:mm:ss")),d.Bb(3),d.vc(i.gameMusic.music.guessAccuracy||"-"),d.Bb(2),d.vc(i.gameMusic.music.playNumber),d.Bb(2),d.hc("ngIf",i.loading)("ngIfElse",e)}},directives:[s.k,v.l,v.g,v.b,v.k,v.e,s.i,F.a],pipes:[s.d],encapsulation:2}),t})();function U(t,i){1&t&&(d.Ob(0),d.Qb(1,"div",3),d.Qb(2,"div",4),d.Qb(3,"span",5),d.uc(4,"Loading..."),d.Pb(),d.Pb(),d.Pb(),d.Nb())}function A(t,i){if(1&t&&(d.Qb(0,"div",20),d.uc(1),d.Pb()),2&t){const t=i.$implicit;d.Bb(1),d.wc(" ",t," ")}}function J(t,i){if(1&t&&(d.Ob(0),d.sc(1,A,2,1,"div",19),d.Nb()),2&t){const t=d.cc(2);d.Bb(1),d.hc("ngForOf",t.musics.errors.apiErrors)}}function X(t,i){1&t&&d.Mb(0,"span",21)}function _(t,i){if(1&t){const t=d.Rb();d.Ob(0),d.Qb(1,"tr",22),d.Yb("onDelete",(function(i){return d.oc(t),d.cc(2).handleGameMusicDeleted(i)})),d.Pb(),d.Nb()}if(2&t){const t=i.$implicit;d.Bb(1),d.hc("gameMusic",t)}}const z=function(t){return{"table-danger":t}};function K(t,i){if(1&t&&(d.Qb(0,"tr",23),d.Qb(1,"th",24),d.uc(2),d.Pb(),d.Qb(3,"td"),d.uc(4),d.Pb(),d.Pb()),2&t){const t=i.$implicit;d.hc("ngClass",d.kc(3,z,!t.enabled)),d.Bb(2),d.vc(t.name),d.Bb(2),d.vc(t.enabled)}}const W=function(t){return{"is-invalid":t}};function T(t,i){if(1&t){const t=d.Rb();d.Qb(0,"h1"),d.uc(1),d.Pb(),d.Qb(2,"div",6),d.Qb(3,"div",7),d.Qb(4,"h2"),d.uc(5,"Musics"),d.Pb(),d.Qb(6,"div",8),d.Qb(7,"label",9),d.uc(8,"add musics"),d.Pb(),d.Qb(9,"input",10),d.Yb("change",(function(i){return d.oc(t),d.cc().fileUpload(i)})),d.Pb(),d.sc(10,J,2,1,"ng-container",11),d.Qb(11,"button",12),d.Yb("click",(function(){d.oc(t);const i=d.cc();return i.uploadLoading||0===i.musicFiles.length||i.uploadMusic()})),d.uc(12," Upload "),d.sc(13,X,1,0,"span",13),d.Pb(),d.Pb(),d.Qb(14,"table",14),d.Qb(15,"thead",15),d.Qb(16,"tr"),d.Qb(17,"th",16),d.uc(18,"title"),d.Pb(),d.Qb(19,"th",16),d.uc(20,"artist"),d.Pb(),d.Qb(21,"th",16),d.uc(22,"duration"),d.Pb(),d.Qb(23,"th",16),d.uc(24,"accuracy"),d.Pb(),d.Qb(25,"th",16),d.uc(26,"played"),d.Pb(),d.Qb(27,"th",16),d.uc(28,"action"),d.Pb(),d.Pb(),d.Pb(),d.Qb(29,"tbody"),d.sc(30,_,2,1,"ng-container",17),d.Pb(),d.Pb(),d.Pb(),d.Qb(31,"div",7),d.Qb(32,"table",14),d.Qb(33,"thead",15),d.Qb(34,"tr"),d.Qb(35,"th",16),d.uc(36,"Alternative names"),d.Pb(),d.Qb(37,"th",16),d.uc(38,"Enabled"),d.Pb(),d.Pb(),d.Pb(),d.Qb(39,"tbody"),d.sc(40,K,5,5,"tr",18),d.Pb(),d.Pb(),d.Pb(),d.Pb()}if(2&t){const t=d.cc();d.Bb(1),d.vc(t.game.name),d.Bb(5),d.hc("formGroup",t.musicUploadForm),d.Bb(3),d.hc("ngClass",d.kc(8,W,t.musics.invalid&&(t.musics.dirty||t.musics.touched))),d.Bb(1),d.hc("ngIf",t.musics.errors),d.Bb(1),d.hc("disabled",t.uploadLoading||0===t.musicFiles.length),d.Bb(2),d.hc("ngIf",t.uploadLoading),d.Bb(17),d.hc("ngForOf",t.game.gameMusics),d.Bb(10),d.hc("ngForOf",t.game.alternativeNames)}}const V=[{path:":slug",component:(()=>{class t{constructor(t,i,e){this.adminGameHttpService=t,this.route=i,this.formBuilder=e,this.loading=!1,this.uploadLoading=!1,this.musicFiles=[]}get musics(){return this.musicUploadForm.get("musics")}ngOnInit(){this.loading=!0,this.adminGameHttpService.get(this.route.snapshot.paramMap.get("slug")).subscribe(t=>{this.game=new u(t),this.loading=!1}),this.musicUploadForm=this.formBuilder.group({musics:[null,[v.p.required.bind(this)]]})}uploadMusic(){this.uploadLoading=!0,this.adminGameHttpService.uploadMusics(this.route.snapshot.paramMap.get("slug"),this.musicFiles).pipe(Object(l.a)(()=>this.uploadLoading=!1)).subscribe(t=>{this.game=new u(t)},t=>{t.errors.forEach(t=>{this.musics.setErrors({apiErrors:t})})})}fileUpload(t){this.musicFiles=t.target.files&&t.target.files.length?t.target.files:[]}handleGameMusicDeleted(t){this.game.gameMusics.splice(this.game.gameMusics.indexOf(this.game.gameMusics.find(i=>i.id===t.id)),1)}}return t.\u0275fac=function(i){return new(i||t)(d.Lb(f),d.Lb(P.a),d.Lb(v.c))},t.\u0275cmp=d.Fb({type:t,selectors:[["app-game-show"]],decls:5,vars:2,consts:[["routerLink","admin/games",1,"btn","btn-info"],[4,"ngIf","ngIfElse"],["gameShow",""],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border","orange"],[1,"sr-only"],[1,"row"],[1,"col-md-6"],[1,"form-group",3,"formGroup"],["for","exampleFormControlFile1"],["type","file","id","exampleFormControlFile1","formControlName","musics","multiple","","accept","audio/mpeg",1,"form-control-file",3,"ngClass","change"],[4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],[1,"table"],[1,"thead-dark"],["scope","col"],[4,"ngFor","ngForOf"],[3,"ngClass",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngFor","ngForOf"],[1,"invalid-feedback"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],["musicRow","",3,"gameMusic","onDelete"],[3,"ngClass"],["scope","row"]],template:function(t,i){if(1&t&&(d.Qb(0,"a",0),d.uc(1,"back to list"),d.Pb(),d.sc(2,U,5,0,"ng-container",1),d.sc(3,T,41,10,"ng-template",null,2,d.tc)),2&t){const t=d.nc(4);d.Bb(2),d.hc("ngIf",i.loading)("ngIfElse",t)}},directives:[P.e,s.k,v.l,v.g,v.b,v.k,v.e,s.i,s.j,Y],encapsulation:2}),t})()},{path:"",component:k}];let Z=(()=>{class t{}return t.\u0275mod=d.Jb({type:t}),t.\u0275inj=d.Ib({factory:function(i){return new(i||t)},imports:[[s.b,P.f.forChild(V),I.a]]}),t})()}}]);