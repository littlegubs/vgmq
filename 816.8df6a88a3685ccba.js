"use strict";(self.webpackChunkvgmq=self.webpackChunkvgmq||[]).push([[816],{2816:(I,c,i)=>{i.r(c),i.d(c,{ProfileModule:()=>M});var l=i(6814),n=i(6223),e=i(9212),w=i(7700),f=i(553),g=i(9862);let m=(()=>{class t{http;apiEndpoint=f.N.apiEndpoint;constructor(s){this.http=s}getCurrentUser(){return this.http.get(`${this.apiEndpoint}/users/current`)}updatePassword(s,o){return this.http.post(`${this.apiEndpoint}/users/password/update`,{password:s,newPassword:o})}deleteUser(){return this.http.delete(`${this.apiEndpoint}/users`)}static \u0275fac=function(o){return new(o||t)(e.LFG(g.eN))};static \u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var h=i(304);function v(t,a){if(1&t&&(e.TgZ(0,"p",7),e._uU(1),e.qZA()),2&t){const s=e.oxw();e.xp6(),e.Oqu(s.errorMessage)}}let b=(()=>{class t{dialogRef;profileHttpService;authService;errorMessage;constructor(s,o,r){this.dialogRef=s,this.profileHttpService=o,this.authService=r}submit(){this.profileHttpService.deleteUser().subscribe({next:()=>{this.dialogRef.close(),this.authService.logout()},error:({error:s})=>{this.errorMessage=s.message}})}close(){this.dialogRef.close()}static \u0275fac=function(o){return new(o||t)(e.Y36(w.so),e.Y36(m),e.Y36(h.e))};static \u0275cmp=e.Xpm({type:t,selectors:[["app-confirm-delete-dialog"]],decls:11,vars:1,consts:[[1,"tw-flex","tw-flex-col","tw-items-center","!tw-bg-grey"],[1,"!tw-mb-6","!tw-mt-2","tw-text-white","!tw-font-fastup","!tw-text-5xl","tw-text-center","tw-px-6"],[1,"tw-text-center","tw-font-bold"],[1,"tw-flex","tw-justify-center","tw-pb-4"],[1,"btn","tw-bg-red","tw-border-none","tw-text-white","hover:tw-border-solid","hover:tw-border-red",3,"click"],[1,"tw-ml-4","btn","btn-outline-primary",3,"click"],["class","text-danger tw-text-center",4,"ngIf"],[1,"text-danger","tw-text-center"]],template:function(o,r){1&o&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2," Confirm Delete account "),e.qZA(),e.TgZ(3,"p",2),e._uU(4,"This action is irreversible, are you sure ?"),e.qZA(),e.TgZ(5,"div",3)(6,"button",4),e.NdJ("click",function(){return r.submit()}),e._uU(7," Delete "),e.qZA(),e.TgZ(8,"button",5),e.NdJ("click",function(){return r.close()}),e._uU(9,"Cancel"),e.qZA()(),e.YNc(10,v,2,1,"p",6),e.qZA()),2&o&&(e.xp6(10),e.Q6J("ngIf",r.errorMessage))},dependencies:[l.O5],encapsulation:2})}return t})();var x=i(4716),d=i(3305);function Z(t,a){1&t&&(e.TgZ(0,"p",18),e._uU(1,"Passwords not match"),e.qZA())}function y(t,a){if(1&t&&(e.TgZ(0,"p",19),e._uU(1),e.qZA()),2&t){const s=e.oxw();e.xp6(),e.Oqu(s.errorMessage)}}function C(t,a){if(1&t&&(e.TgZ(0,"p",20),e._uU(1),e.qZA()),2&t){const s=e.oxw();e.xp6(),e.Oqu(s.successMessage)}}function U(t,a){1&t&&e._UZ(0,"span",21)}function T(t,a){1&t&&e._UZ(0,"span",21)}const p=t=>({"is-invalid":t});let F=(()=>{class t{dialog;profileHttpService;user;userSub;loading=!1;errorMessage;successMessage;passwordForm=new n.cw({currentPassword:new n.NI("",n.kI.required.bind(this)),newPassword:new n.NI("",[n.kI.required.bind(this),n.kI.minLength(3)]),confirmNewPassword:new n.NI("",[n.kI.required.bind(this),n.kI.minLength(3)])},{validators:t=>{const a=t.get("newPassword"),s=t.get("confirmNewPassword");return a&&s&&a.value!==s.value?{passwordMismatch:!0}:null}});constructor(s,o){this.dialog=s,this.profileHttpService=o}submitUpdatePassword(){this.errorMessage=void 0,this.successMessage=void 0,this.loading=!0;const s=this.passwordForm.value;this.profileHttpService.updatePassword(s.currentPassword,s.newPassword).pipe((0,x.x)(()=>{this.loading=!1,this.passwordForm.reset()})).subscribe({next:()=>{this.successMessage="Password changed successfully"},error:({error:o})=>{this.errorMessage=o.message}})}openDeleteDialog(){this.dialog.open(b)}ngOnInit(){this.userSub=this.profileHttpService.getCurrentUser().subscribe(s=>{this.user=s})}ngOnDestroy(){this.userSub.unsubscribe()}static \u0275fac=function(o){return new(o||t)(e.Y36(w.uw),e.Y36(m))};static \u0275cmp=e.Xpm({type:t,selectors:[["app-profile"]],decls:46,vars:22,consts:[[1,"tw-flex","tw-flex-col","md:tw-flex-row","tw-w-full","md:tw-justify-center","tw-items-center"],[1,"tw-flex","tw-flex-col","tw-flex-1"],[1,"tw-text-center","!tw-text-2xl","!tw-font-fastup"],[1,"tw-font-bold"],[1,"tw-my-4"],[1,"!tw-bg-newBlack"],[1,"tw-flex","tw-flex-col","tw-items-center"],[1,"tw-w-3/4",3,"formGroup","ngSubmit"],["type","password","required","","formControlName","currentPassword","placeholder","Current Password",1,"form-control","!tw-bg-grey","tw-rounded-md","placeholder:tw-text-light-grey","tw-mt-2",3,"ngClass"],["type","password","required","","formControlName","newPassword","placeholder","New Password",1,"form-control","!tw-bg-grey","tw-rounded-md","placeholder:tw-text-light-grey","tw-my-4",3,"ngClass"],["type","password","required","","formControlName","confirmNewPassword","placeholder","Confirm new password",1,"form-control","!tw-bg-grey","tw-rounded-md","placeholder:tw-text-light-grey",3,"ngClass"],["class","!tw-my-4",4,"ngIf"],["class","!tw-my-4 text-danger tw-text-center",4,"ngIf"],["class","!tw-my-4 text-success tw-text-center",4,"ngIf"],["type","submit",1,"btn","btn-outline-primary",3,"disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],[1,"tw-flex","tw-justify-center","tw-mt-2"],[1,"btn","tw-bg-red","tw-border-none","tw-text-white","hover:tw-border-solid","hover:tw-border-red",3,"click"],[1,"!tw-my-4"],[1,"!tw-my-4","text-danger","tw-text-center"],[1,"!tw-my-4","text-success","tw-text-center"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(o,r){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h4",2),e._uU(3,"Personal Informations"),e.qZA(),e.TgZ(4,"div")(5,"span",3),e._uU(6,"Username:"),e.qZA(),e._uU(7),e.qZA(),e.TgZ(8,"div",4)(9,"span",3),e._uU(10,"Email:"),e.qZA(),e._uU(11),e.qZA(),e.TgZ(12,"div")(13,"span",3),e._uU(14,"Member since:"),e.qZA(),e._uU(15),e.ALo(16,"date"),e.qZA()(),e.TgZ(17,"div",1)(18,"h4",2),e._uU(19,"Settings"),e.qZA(),e.TgZ(20,"mat-accordion")(21,"mat-expansion-panel",5)(22,"mat-expansion-panel-header")(23,"mat-panel-title"),e._uU(24,"Update Password"),e.qZA()(),e.TgZ(25,"div",6)(26,"form",7),e.NdJ("ngSubmit",function(){return r.submitUpdatePassword()}),e._UZ(27,"input",8)(28,"input",9)(29,"input",10),e.TgZ(30,"div",6),e.YNc(31,Z,2,0,"p",11)(32,y,2,1,"p",12)(33,C,2,1,"p",13),e.TgZ(34,"div",4)(35,"button",14),e._uU(36," Update"),e.YNc(37,U,1,0,"span",15),e.qZA()()()()()(),e.TgZ(38,"mat-expansion-panel",5)(39,"mat-expansion-panel-header")(40,"mat-panel-title"),e._uU(41,"Delete Account"),e.qZA()(),e.TgZ(42,"div",16)(43,"button",17),e.NdJ("click",function(){return r.openDeleteDialog()}),e._uU(44," Delete my account"),e.YNc(45,T,1,0,"span",15),e.qZA()()()()()()),2&o&&(e.xp6(7),e.hij(" ",null==r.user?null:r.user.username,""),e.xp6(4),e.hij(" ",null==r.user?null:r.user.email,""),e.xp6(4),e.hij(" ",e.xi3(16,13,null==r.user?null:r.user.createdAt,"MM-dd-YYYY"),""),e.xp6(11),e.Q6J("formGroup",r.passwordForm),e.xp6(),e.Q6J("ngClass",e.VKq(16,p,r.passwordForm.get("currentPassword")&&r.passwordForm.get("currentPassword").invalid&&(r.passwordForm.get("currentPassword").dirty||r.passwordForm.get("currentPassword").touched))),e.xp6(),e.Q6J("ngClass",e.VKq(18,p,r.passwordForm.get("newPassword")&&r.passwordForm.get("newPassword").invalid&&(r.passwordForm.get("newPassword").dirty||r.passwordForm.get("newPassword").touched))),e.xp6(),e.Q6J("ngClass",e.VKq(20,p,r.passwordForm.get("confirmNewPassword")&&r.passwordForm.get("confirmNewPassword").invalid&&(r.passwordForm.get("confirmNewPassword").dirty||r.passwordForm.get("confirmNewPassword").touched))),e.xp6(2),e.Q6J("ngIf",null==r.passwordForm.errors?null:r.passwordForm.errors.passwordMismatch),e.xp6(),e.Q6J("ngIf",r.errorMessage),e.xp6(),e.Q6J("ngIf",r.successMessage),e.xp6(2),e.Q6J("disabled",r.passwordForm.invalid||(null==r.passwordForm.errors?null:r.passwordForm.errors.passwordMismatch)),e.xp6(2),e.Q6J("ngIf",r.loading),e.xp6(8),e.Q6J("ngIf",r.loading))},dependencies:[l.mk,l.O5,d.pp,d.ib,d.yz,d.yK,n._Y,n.Fj,n.JJ,n.JL,n.Q7,n.sg,n.u,l.uU],encapsulation:2})}return t})();var A=i(2787),N=i(2132);const q=[{path:"",component:F}];let M=(()=>{class t{static \u0275fac=function(o){return new(o||t)};static \u0275mod=e.oAB({type:t});static \u0275inj=e.cJS({imports:[l.ez,A.Bz.forChild(q),N.m]})}return t})()}}]);