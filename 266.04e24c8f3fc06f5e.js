"use strict";(self.webpackChunkvgmq=self.webpackChunkvgmq||[]).push([[266],{9266:(se,u,s)=>{s.r(u),s.d(u,{GameModule:()=>ie});var m=s(9808),c=s(7771),h=s(1837),v=s(6082),e=s(5e3),g=s(9743),x=s(263);const Z=function(n){return["/admin/games/",n]};function T(n,i){if(1&n&&(e.TgZ(0,"a",11),e._uU(1,"admin"),e.qZA()),2&n){const t=e.oxw(2);e.Q6J("routerLink",e.VKq(1,Z,t.game.slug))}}const G=function(n){return{"background-color":n}};function b(n,i){if(1&n&&(e.TgZ(0,"span",12),e._uU(1),e.qZA()),2&n){const t=i.$implicit,o=e.oxw(2);e.Q6J("ngStyle",e.VKq(2,G,o.game.cover?o.game.cover.colorPalette.backgroundColorHex:"black")),e.xp6(1),e.Oqu(t.abbreviation)}}function I(n,i){if(1&n&&(e.TgZ(0,"div")(1,"small"),e._uU(2," from "),e.TgZ(3,"span",23),e._uU(4),e.qZA()()()),2&n){const t=e.oxw().$implicit;e.xp6(4),e.hij(" ",t.originalGameToMusic.game.name," ")}}function w(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"span",23),e._uU(2),e.qZA(),e._uU(3),e.BQk()),2&n){const t=i.$implicit,o=i.last;e.xp6(2),e.Oqu(t.game.name),e.xp6(1),e.hij("",o?"":", "," ")}}function C(n,i){if(1&n&&(e.TgZ(0,"div",16)(1,"small",24),e._uU(2," Also appears in "),e.YNc(3,w,4,2,"ng-container",25),e.qZA()()),2&n){const t=e.oxw().$implicit;e.xp6(3),e.Q6J("ngForOf",t.derivedGameToMusics)}}function y(n,i){if(1&n&&(e.TgZ(0,"div",19)(1,"div",20)(2,"div",16),e.YNc(3,I,5,1,"div",21),e._uU(4),e.qZA(),e.TgZ(5,"div",16),e._uU(6),e.qZA(),e.TgZ(7,"div",17),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"div",17),e._uU(11),e.ALo(12,"number"),e.qZA(),e.YNc(13,C,4,1,"div",22),e.qZA()()),2&n){const t=i.$implicit,o=e.oxw(3);let r,l;e.xp6(3),e.Q6J("ngIf",t.type!==o.gameToMusicType.Original),e.xp6(1),e.hij(" ",null!==(r=t.title)&&void 0!==r?r:t.music.title," "),e.xp6(2),e.Oqu(null!==(l=t.artist)&&void 0!==l?l:t.music.artist),e.xp6(2),e.Oqu(e.xi3(9,6,o.getDuration(t),"mm:ss")),e.xp6(3),e.hij(" ",null!==t.guessAccuracy?e.xi3(12,9,100*t.guessAccuracy,"1.0-2")+"%":"-"," "),e.xp6(2),e.Q6J("ngIf",t.derivedGameToMusics&&t.derivedGameToMusics.length>0)}}function A(n,i){if(1&n&&(e.TgZ(0,"div",13)(1,"h2"),e._uU(2,"Music list"),e.qZA(),e.TgZ(3,"div",14)(4,"div",15)(5,"div",16),e._uU(6,"title"),e.qZA(),e.TgZ(7,"div",16),e._uU(8,"artist"),e.qZA(),e.TgZ(9,"div",17),e._uU(10,"duration"),e.qZA(),e.TgZ(11,"div",17),e._uU(12,"accuracy"),e.qZA()(),e.YNc(13,y,14,12,"div",18),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(13),e.Q6J("ngForOf",t.game.musics)}}function q(n,i){if(1&n&&(e.TgZ(0,"div",28),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function J(n,i){if(1&n&&(e.TgZ(0,"div",26)(1,"h2"),e._uU(2,"Alternative names"),e.qZA(),e.YNc(3,q,2,1,"div",27),e.qZA()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("ngForOf",t.getEnabledAlternativeNames())}}function U(n,i){if(1&n&&(e.TgZ(0,"div",2)(1,"div",3)(2,"div",4)(3,"h1"),e._uU(4),e.qZA()(),e.TgZ(5,"div",5)(6,"a",6),e._uU(7,"IGDB"),e.qZA(),e.YNc(8,T,2,3,"a",7),e.qZA()(),e.TgZ(9,"h4"),e.YNc(10,b,2,4,"span",8),e.qZA(),e.TgZ(11,"div",3),e.YNc(12,A,14,1,"div",9),e.YNc(13,J,4,1,"div",10),e.qZA()()),2&n){const t=e.oxw();e.Q6J("ngStyle",t.getGradientBackground()),e.xp6(4),e.Oqu(t.game.name),e.xp6(2),e.Q6J("href",t.game.url,e.LSH),e.xp6(2),e.Q6J("ngIf",t.isAdmin),e.xp6(2),e.Q6J("ngForOf",t.game.platforms),e.xp6(2),e.Q6J("ngIf",t.game.musics.length>0),e.xp6(1),e.Q6J("ngIf",t.getEnabledAlternativeNames().length>0)}}function S(n,i){1&n&&(e.TgZ(0,"div",29),e._UZ(1,"h1",30),e.qZA())}let _=(()=>{class n{constructor(t,o,r){this.gameHttpService=t,this.viewportScroller=o,this.authService=r,this.loading=!1,this.gameToMusicType=v.U,this.isAdmin=!1}set slug(t){this.loading=!0,this.gameHttpService.get(t).subscribe(o=>{this.game=o,this.loading=!1})}ngOnInit(){this.isAdmin=this.authService.isAdmin}getDuration(t){return h.ou.fromSeconds(t.music.duration).toJSDate()}getEnabledAlternativeNames(){return this.game.alternativeNames.filter(t=>t.enabled)}getGradientBackground(){if(!this.game.cover)return null;const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(this.game.cover.colorPalette.backgroundColorHex);return parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),{"background-image":`linear-gradient(to bottom, rgba(20, 21, 22, 0.70), rgba(20, 21, 22, 1) 150px), url(https://images.igdb.com/igdb/image/upload/t_screenshot_huge/${this.game.cover.imageId}.jpg)`}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(g.q),e.Y36(m.EM),e.Y36(x.e))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-game-show"]],inputs:{slug:"slug"},decls:3,vars:2,consts:[["id","sex","class","bg-dark p-4",3,"ngStyle",4,"ngIf","ngIfElse"],["skeleton",""],["id","sex",1,"bg-dark","p-4",3,"ngStyle"],[1,"row","justify-content-between"],[1,"col-md-5"],[1,"col","text-end"],["target","_blank",1,"btn","text-white",2,"background-color","#9147ff",3,"href"],["class","btn btn-primary","target","_blank",3,"routerLink",4,"ngIf"],["class","badge text-white",3,"ngStyle",4,"ngFor","ngForOf"],["class","col-md-8","style","overflow: auto; max-height: 90vh",4,"ngIf"],["class","col-md-3 alternative-name-container",4,"ngIf"],["target","_blank",1,"btn","btn-primary",3,"routerLink"],[1,"badge","text-white",3,"ngStyle"],[1,"col-md-8",2,"overflow","auto","max-height","90vh"],[2,"overflow","visible"],[1,"row",2,"padding","10px"],[1,"col-5"],[1,"col-1"],["class","music-list",4,"ngFor","ngForOf"],[1,"music-list"],[1,"row"],[4,"ngIf"],["class","col-5",4,"ngIf"],[1,"text-primary"],[1,"text-muted-light"],[4,"ngFor","ngForOf"],[1,"col-md-3","alternative-name-container"],["class","alternative-name",4,"ngFor","ngForOf"],[1,"alternative-name"],[1,"col-md-12","bg-dark","p-4"],[1,"placeholder","col-md-2"]],template:function(t,o){if(1&t&&(e.YNc(0,U,14,7,"div",0),e.YNc(1,S,2,0,"ng-template",null,1,e.W1O)),2&t){const r=e.MAs(2);e.Q6J("ngIf",!o.loading)("ngIfElse",r)}},dependencies:[m.sg,m.O5,m.PC,c.yS,m.JJ,m.uU],encapsulation:2}),n})();var N=s(3149),Q=s(8372),d=s(8746),a=s(3075),p=s(2349);function Y(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.form.errors.serverError," ")}}function L(n,i){if(1&n&&(e.TgZ(0,"div",12),e.YNc(1,Y,2,1,"ng-container",7),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.form.errors.serverError)}}function F(n,i){if(1&n&&(e.TgZ(0,"p",13),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(t.errorMessage)}}function M(n,i){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.Oqu(t)}}function O(n,i){if(1&n&&(e.TgZ(0,"div")(1,"p",14),e._uU(2),e.qZA(),e.TgZ(3,"ul"),e.YNc(4,M,2,1,"li",15),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.hij("Successfully imported ",t.importedGames.length," games!"),e.xp6(2),e.Q6J("ngForOf",t.importedGames)}}function k(n,i){1&n&&e._UZ(0,"span",16)}const D=function(n){return{"is-invalid":n}},j=function(n){return{disabled:n}};let B=(()=>{class n{constructor(t,o){this.dialogRef=t,this.gameHttpService=o,this.loading=!1,this.form=new a.NI(null,a.kI.required.bind(this)),this.importedGames=[]}submit(){this.errorMessage=void 0,this.loading=!0,this.importedGames=[],this.gameHttpService.importByUrl(this.form.value).pipe((0,d.x)(()=>this.loading=!1)).subscribe({next:t=>{this.importedGames=t,this.form.reset()},error:t=>{Array.isArray(t.message)?this.form.setErrors({serverError:t.message[0].errors}):this.errorMessage=t.message}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.so),e.Y36(g.q))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-import-game-dialog"]],decls:26,vars:12,consts:[["href","https://www.igdb.com/search","target","_blank"],[1,"text-primary"],["href","https://discord.com/channels/978654868296331314/1036244380031402075","target","_blank"],[1,"form-group",3,"ngSubmit"],["required","","placeholder","IGDB url (ex: https://www.igdb.com/games/nier-automata)",1,"form-control",3,"formControl","ngClass"],["class","invalid-feedback",4,"ngIf"],["class","text-danger",4,"ngIf"],[4,"ngIf"],["mat-dialog-actions","",1,"row","justify-content-end"],[1,"col"],[1,"btn","btn-outline-primary",3,"disabled","ngClass","click"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],[1,"invalid-feedback"],[1,"text-danger"],[1,"text-success"],[4,"ngFor","ngForOf"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(t,o){1&t&&(e.TgZ(0,"h2"),e._uU(1,"Import a game"),e.qZA(),e.TgZ(2,"p"),e._uU(3," import a game from "),e.TgZ(4,"a",0),e._uU(5,"igdb.com"),e.qZA(),e._uU(6," by searching a game and copying its url below\n"),e.qZA(),e.TgZ(7,"p"),e._uU(8," You are only allowed to import what IGDB calls "),e.TgZ(9,"b",1),e._uU(10,'"main games"'),e.qZA(),e._uU(11,"."),e._UZ(12,"br"),e._uU(13," If you want to add a DLC, expansion, chapter, etc... please request your game in "),e.TgZ(14,"a",2),e._uU(15," the dedicated Discord channel "),e.qZA()(),e.TgZ(16,"form",3),e.NdJ("ngSubmit",function(){return o.submit()}),e._UZ(17,"input",4),e.YNc(18,L,2,1,"div",5),e.qZA(),e.YNc(19,F,2,1,"p",6),e.YNc(20,O,5,2,"div",7),e.TgZ(21,"div",8)(22,"div",9)(23,"button",10),e.NdJ("click",function(){return o.form.invalid||o.loading||o.submit()}),e._uU(24," Import"),e.YNc(25,k,1,0,"span",11),e.qZA()()()),2&t&&(e.xp6(17),e.Q6J("formControl",o.form)("ngClass",e.VKq(8,D,o.form.invalid&&(o.form.dirty||o.form.touched))),e.xp6(1),e.Q6J("ngIf",o.form.errors),e.xp6(1),e.Q6J("ngIf",o.errorMessage),e.xp6(1),e.Q6J("ngIf",o.importedGames.length>0),e.xp6(3),e.Q6J("disabled",o.form.invalid||o.loading)("ngClass",e.VKq(10,j,o.form.invalid||o.loading)),e.xp6(2),e.Q6J("ngIf",o.loading))},dependencies:[m.mk,m.sg,m.O5,p.H8,a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.F,a.oH],encapsulation:2}),n})();var H=s(7446),E=s(8636),f=s(9685);function R(n,i){if(1&n&&(e.TgZ(0,"h1"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij("",t.gamesCount," games")}}function $(n,i){if(1&n&&(e.TgZ(0,"form",9)(1,"div",10)(2,"div",11)(3,"div",12),e._UZ(4,"input",13),e.qZA()(),e.TgZ(5,"div",2)(6,"div",12)(7,"mat-checkbox",14),e._uU(8,"Only Show My Games"),e.qZA()()()()()),2&n){const t=e.oxw();e.Q6J("formGroup",t.form)}}function z(n,i){1&n&&(e.ynx(0),e.TgZ(1,"div",15)(2,"div",16)(3,"span",17),e._uU(4,"Loading..."),e.qZA()()(),e.BQk())}function W(n,i){if(1&n&&e._UZ(0,"app-game-show",23),2&n){const t=e.oxw(4);e.Q6J("slug",t.games[t.selectedGameIndex].slug)}}function K(n,i){if(1&n&&e._UZ(0,"app-game-show",23),2&n){const t=e.oxw(4);e.Q6J("slug",t.games[t.selectedGameIndex].slug)}}function P(n,i){if(1&n&&(e.ynx(0),e.YNc(1,W,1,1,"app-game-show",22),e.YNc(2,K,1,1,"app-game-show",22),e.BQk()),2&n){const t=e.oxw().index,o=e.oxw(2);e.xp6(1),e.Q6J("ngIf",o.innerWidth>=768&&((t+1)%6==0||o.games.length===t+1)&&o.getNextGameShowIndex(t,6)),e.xp6(1),e.Q6J("ngIf",o.innerWidth<768&&((t+1)%2==0||o.games.length===t+1)&&o.getNextGameShowIndex(t,2))}}function V(n,i){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-game-item",21),e.NdJ("selected",function(){const l=e.CHM(t).index,ae=e.oxw(2);return e.KtG(ae.selectGame(l))}),e.qZA(),e.YNc(2,P,3,2,"ng-container",3),e.BQk()}if(2&n){const t=i.$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("game",t),e.xp6(1),e.Q6J("ngIf",void 0!==o.selectedGameIndex)}}function X(n,i){1&n&&(e.TgZ(0,"div",15)(1,"div",24)(2,"span",17),e._uU(3,"Loading..."),e.qZA()()())}function ee(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",18),e.NdJ("scrolled",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onScrollDown())}),e.YNc(1,V,3,2,"ng-container",19),e.YNc(2,X,4,0,"div",20),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.games),e.xp6(1),e.Q6J("ngIf",t.scrollLoading)}}let te=(()=>{class n{constructor(t,o,r,l){this.gameHttpService=t,this.router=o,this.activatedRoute=r,this.dialog=l,this.games=[],this.loading=!1,this.myGames=!1,this.scrollLoading=!1}ngOnInit(){this.innerWidth=window.innerWidth,this.activatedRoute.queryParamMap.subscribe(t=>{var o;this.form=new a.cw({query:new a.NI(null!==(o=t.get("query"))&&void 0!==o?o:"",a.kI.required.bind(this)),myGames:new a.NI("true"===t.get("myGames"))}),this.search()}).unsubscribe(),this.form.valueChanges.pipe((0,Q.b)(250)).subscribe(()=>{this.search(),this.router.navigate([],{relativeTo:this.activatedRoute,queryParams:this.form.value,replaceUrl:!0})})}search(){this.loading=!0,this.selectedGameIndex=void 0,this.gameHttpService.search(this.form.value,0,24).pipe((0,d.x)(()=>this.loading=!1)).subscribe(t=>{this.gamesCount=t.count,this.games=t.data})}onScrollDown(){this.scrollLoading||(this.scrollLoading=!0,this.gameHttpService.search(this.form.value,this.games.length,24).pipe((0,d.x)(()=>this.scrollLoading=!1)).subscribe(t=>{this.games=[...this.games,...t.data]}))}openImportDialog(){this.dialog.open(B).afterClosed().subscribe(()=>{this.search()})}getRow(t,o){return Math.floor(t/o)}getNextGameShowIndex(t,o){return this.getRow(t,o)===Math.floor(this.selectedGameIndex/o)}onResize(){this.innerWidth=window.innerWidth}selectGame(t){this.selectedGameIndex=t}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(g.q),e.Y36(c.F0),e.Y36(c.gz),e.Y36(p.uw))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-game-list"]],hostBindings:function(t,o){1&t&&e.NdJ("resize",function(l){return o.onResize(l)},!1,e.Jf7)},decls:11,vars:4,consts:[[1,"container"],[1,"row","justify-content-between"],[1,"col"],[4,"ngIf"],[1,"col","text-end"],[1,"btn","btn-outline-primary",3,"click"],[3,"formGroup",4,"ngIf"],[4,"ngIf","ngIfElse"],["cardColumns",""],[3,"formGroup"],[1,"row","justify-content-between","align-items-center"],[1,"col-md-3"],[1,"form-group"],["type","text","id","exampleFormControlInput1","placeholder","game...","formControlName","query",1,"form-control"],["color","primary","formControlName","myGames"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border","orange"],[1,"sr-only"],["infinite-scroll","",1,"mt-4","row",3,"scrolled"],[4,"ngFor","ngForOf"],["class","d-flex justify-content-center",4,"ngIf"],[1,"col-6","col-md-2",3,"game","selected"],["class","col-12 mb-4",3,"slug",4,"ngIf"],[1,"col-12","mb-4",3,"slug"],["role","status",1,"spinner-border","text-primary"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,R,2,1,"h1",3),e.qZA(),e.TgZ(4,"div",4)(5,"button",5),e.NdJ("click",function(){return o.openImportDialog()}),e._uU(6,"Import game from IGDB"),e.qZA()()(),e.YNc(7,$,9,1,"form",6),e.YNc(8,z,5,0,"ng-container",7),e.YNc(9,ee,3,2,"ng-template",null,8,e.W1O),e.qZA()),2&t){const r=e.MAs(10);e.xp6(3),e.Q6J("ngIf",o.gamesCount),e.xp6(4),e.Q6J("ngIf",o.form),e.xp6(1),e.Q6J("ngIf",o.loading)("ngIfElse",r)}},dependencies:[m.sg,m.O5,H.oG,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,E.F,f.Ry,_],encapsulation:2}),n})();var ne=s(5245);const oe=[{path:":slug",component:_},{path:"",component:te}];let ie=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[m.ez,c.Bz.forChild(oe),N.m,ne.Ps,f.Rq]}),n})()}}]);