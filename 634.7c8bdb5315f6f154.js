"use strict";(self.webpackChunkvgmq=self.webpackChunkvgmq||[]).push([[634],{492:(N,x,c)=>{c.d(x,{I:()=>I});var t=c(2843),e=c(2340),_=c(262),b=c(5e3),S=c(520);let I=(()=>{class d{constructor(p){this.http=p,this.apiEndpoint=e.N.apiEndpoint}search(p,f,E){return this.http.get(`${this.apiEndpoint}/admin/games`,{params:{query:p.query,...p.showDisabled&&{showDisabled:"true"},...p.onlyShowWithoutMusics&&{onlyShowWithoutMusics:"true"},...f&&{skip:f},...E&&{limit:E}}})}importByUrl(p){return this.http.get(`${this.apiEndpoint}/admin/games/import`,{params:{url:p}}).pipe((0,_.K)(f=>(0,t._)(f.error)))}get(p){return this.http.get(`${this.apiEndpoint}/admin/games/${p}`)}uploadMusics(p,f){const E=new FormData;for(const U of f)E.append("files",U);return this.http.post(`${this.apiEndpoint}/admin/games/${p}/musics`,E,{reportProgress:!0,observe:"events"})}saveMusic(p,f){return this.http.patch(`${this.apiEndpoint}/admin/game-to-music/${p.id}`,f)}deleteGameMusic(p){return this.http.delete(`${this.apiEndpoint}/admin/game-to-music/${p.id}`)}toggleGame(p){return this.http.patch(`${this.apiEndpoint}/admin/games/${p.slug}/toggle`,null).pipe((0,_.K)(f=>(0,t._)(f.error)))}toggleAlternativeName(p){return this.http.patch(`${this.apiEndpoint}/alternative-names/${p.id}/toggle`,null).pipe((0,_.K)(f=>(0,t._)(f.error)))}listen(p){return this.http.get(`${this.apiEndpoint}/admin/game-to-music/${p}/listen`,{responseType:"blob"})}addDerivedGameToMusic(p,f){return this.http.post(`${this.apiEndpoint}/admin/game-to-music/${p}/add-derived`,{gameId:f.id}).pipe((0,_.K)(E=>(0,t._)(E.error)))}}return d.\u0275fac=function(p){return new(p||d)(b.LFG(S.eN))},d.\u0275prov=b.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},9743:(N,x,c)=>{c.d(x,{q:()=>b});var t=c(2340),e=c(5e3),_=c(520);let b=(()=>{class S{constructor(d){this.http=d,this.apiEndpoint=t.N.apiEndpoint}search(d,w,p){return this.http.get(`${this.apiEndpoint}/games`,{params:{query:d.query,...d.myGames&&{filterByUser:"true"},...w&&{skip:w},...p&&{limit:p}}})}get(d){return this.http.get(`${this.apiEndpoint}/games/${d}`)}addToList(d){return this.http.get(`${this.apiEndpoint}/games/${d}/add`)}removeFromList(d){return this.http.get(`${this.apiEndpoint}/games/${d}/remove`)}getNames(d){return this.http.get(`${this.apiEndpoint}/games/names`,{params:{query:d}})}}return S.\u0275fac=function(d){return new(d||S)(e.LFG(_.eN))},S.\u0275prov=e.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})()},3818:(N,x,c)=>{c.d(x,{X:()=>J});var t=c(5e3),e=c(8372),_=c(3075),b=c(8746),S=c(2349),I=c(492),d=c(9808);function w(a,s){if(1&a&&(t.ynx(0),t._uU(1),t.BQk()),2&a){const r=t.oxw(2);t.xp6(1),t.hij(" ",r.form.errors.serverError," ")}}function p(a,s){if(1&a&&(t.TgZ(0,"div",9),t.YNc(1,w,2,1,"ng-container",4),t.qZA()),2&a){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",r.form.errors.serverError)}}function f(a,s){if(1&a&&(t.TgZ(0,"li"),t._uU(1),t.qZA()),2&a){const r=s.$implicit;t.xp6(1),t.Oqu(r)}}function E(a,s){if(1&a&&(t.TgZ(0,"div")(1,"p",10),t._uU(2),t.qZA(),t.TgZ(3,"ul"),t.YNc(4,f,2,1,"li",11),t.qZA()()),2&a){const r=t.oxw();t.xp6(2),t.hij("Successfully imported ",r.importedGames.length," games!"),t.xp6(2),t.Q6J("ngForOf",r.importedGames)}}function U(a,s){1&a&&t._UZ(0,"span",12)}const H=function(a){return{"is-invalid":a}},K=function(a){return{disabled:a}};let W=(()=>{class a{constructor(r,i){this.dialogRef=r,this.gameHttpService=i,this.loading=!1,this.form=new _.NI(null,_.kI.required.bind(this)),this.importedGames=[]}ngOnInit(){}submit(){this.loading=!0,this.importedGames=[],this.gameHttpService.importByUrl(this.form.value).pipe((0,b.x)(()=>this.loading=!1)).subscribe({next:r=>{this.importedGames=r,this.form.reset()},error:r=>{Array.isArray(r.message)?this.form.setErrors({serverError:r.message[0].errors}):this.errorMessage=r.message}})}}return a.\u0275fac=function(r){return new(r||a)(t.Y36(S.so),t.Y36(I.I))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-import-game-dialog"]],decls:16,vars:11,consts:[["href","https://www.igdb.com/search","target","_blank"],[1,"form-group"],["required","","placeholder","IGDB url",1,"form-control",3,"formControl","ngClass"],["class","invalid-feedback",4,"ngIf"],[4,"ngIf"],["mat-dialog-actions","",1,"row","justify-content-end"],[1,"col"],[1,"btn","btn-outline-primary",3,"disabled","ngClass","click"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],[1,"invalid-feedback"],[1,"text-success"],[4,"ngFor","ngForOf"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"]],template:function(r,i){1&r&&(t.TgZ(0,"h2"),t._uU(1,"Import a game"),t.qZA(),t.TgZ(2,"p"),t._uU(3," import a game from "),t.TgZ(4,"a",0),t._uU(5,"igdb.com"),t.qZA(),t._uU(6," by searching a game and copying its url below\n"),t.qZA(),t.TgZ(7,"div",1),t._UZ(8,"input",2),t.YNc(9,p,2,1,"div",3),t.qZA(),t.YNc(10,E,5,2,"div",4),t.TgZ(11,"div",5)(12,"div",6)(13,"button",7),t.NdJ("click",function(){return i.form.invalid||i.loading||i.submit()}),t._uU(14," Import"),t.YNc(15,U,1,0,"span",8),t.qZA()()()),2&r&&(t.xp6(8),t.Q6J("formControl",i.form)("ngClass",t.VKq(7,H,i.form.invalid&&(i.form.dirty||i.form.touched))),t.xp6(1),t.Q6J("ngIf",i.form.errors),t.xp6(1),t.Q6J("ngIf",i.importedGames.length>0),t.xp6(3),t.Q6J("disabled",i.form.invalid||i.loading)("ngClass",t.VKq(9,K,i.form.invalid||i.loading)),t.xp6(2),t.Q6J("ngIf",i.loading))},dependencies:[d.mk,d.sg,d.O5,S.H8,_.Fj,_.JJ,_.Q7,_.oH],encapsulation:2}),a})();var F=c(7961),Z=c(7771);function L(a,s){if(1&a&&(t.TgZ(0,"h1"),t._uU(1),t.qZA()),2&a){const r=t.oxw();t.xp6(1),t.hij("",r.gamesCount," games")}}function M(a,s){if(1&a&&(t.TgZ(0,"form",8)(1,"div",9)(2,"div",10)(3,"div",11),t._UZ(4,"input",12),t.qZA()(),t.TgZ(5,"div",1)(6,"mat-checkbox",13),t._uU(7,"Only Show Without Music"),t.qZA()(),t.TgZ(8,"div",1)(9,"mat-checkbox",14),t._uU(10,"Disabled "),t.qZA()()()()),2&a){const r=t.oxw();t.Q6J("formGroup",r.form)}}function Y(a,s){1&a&&(t.ynx(0),t.TgZ(1,"div",15)(2,"div",16)(3,"span",17),t._uU(4,"Loading..."),t.qZA()()(),t.BQk())}function O(a,s){1&a&&t._UZ(0,"app-game-item",21),2&a&&t.Q6J("game",s.$implicit)}function G(a,s){1&a&&(t.TgZ(0,"div",15)(1,"div",16)(2,"span",17),t._uU(3,"Loading..."),t.qZA()()())}function B(a,s){if(1&a){const r=t.EpF();t.TgZ(0,"div",18),t.NdJ("scrolled",function(){t.CHM(r);const u=t.oxw();return t.KtG(u.onScrollDown())}),t.YNc(1,O,1,1,"app-game-item",19),t.YNc(2,G,4,0,"div",20),t.qZA()}if(2&a){const r=t.oxw();t.xp6(1),t.Q6J("ngForOf",r.games),t.xp6(1),t.Q6J("ngIf",r.scrollLoading)}}let J=(()=>{class a{constructor(r,i,u,C){this.adminGameHttpService=r,this.dialog=i,this.router=u,this.activatedRoute=C,this.name="xd",this.games=[],this.query="",this.showDisabled=!1,this.onlyShowWithoutMusics=!1,this.loading=!1,this.scrollLoading=!1}ngOnInit(){this.activatedRoute.queryParamMap.subscribe(r=>{var i;this.form=new _.cw({query:new _.NI(null!==(i=r.get("query"))&&void 0!==i?i:"",_.kI.required.bind(this)),showDisabled:new _.NI("true"===r.get("showDisabled")),onlyShowWithoutMusics:new _.NI("true"===r.get("onlyShowWithoutMusics"))}),this.search()}).unsubscribe(),this.form.valueChanges.pipe((0,e.b)(250)).subscribe(()=>{this.search(),this.router.navigate([],{relativeTo:this.activatedRoute,queryParams:this.form.value,replaceUrl:!0})})}search(){this.loading=!0,this.adminGameHttpService.search(this.form.value,0,24).pipe((0,b.x)(()=>this.loading=!1)).subscribe(r=>{this.gamesCount=r.count,this.games=r.data})}onScrollDown(){this.scrollLoading||(this.scrollLoading=!0,this.adminGameHttpService.search(this.form.value,this.games.length,24).pipe((0,b.x)(()=>this.scrollLoading=!1)).subscribe(r=>{this.games=[...this.games,...r.data]}))}openImportDialog(){this.dialog.open(W).afterClosed().subscribe(()=>{this.search()})}}return a.\u0275fac=function(r){return new(r||a)(t.Y36(I.I),t.Y36(S.uw),t.Y36(Z.F0),t.Y36(Z.gz))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-game-search"]],features:[t._Bn([{provide:F.X,useExisting:(0,t.Gpc)(()=>a)}])],decls:10,vars:4,consts:[[1,"row","justify-content-between"],[1,"col"],[4,"ngIf"],[1,"col","text-end"],[1,"btn","btn-outline-primary",3,"click"],[3,"formGroup",4,"ngIf"],[4,"ngIf","ngIfElse"],["cardColumns",""],[3,"formGroup"],[1,"row","justify-content-between","align-items-center"],[1,"col-md-3"],[1,"form-group"],["type","text","id","exampleFormControlInput1","placeholder","game...","formControlName","query",1,"form-control"],["color","primary","formControlName","onlyShowWithoutMusics"],["color","primary","formControlName","showDisabled"],[1,"d-flex","justify-content-center"],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"],["infinite-scroll","",1,"mt-4","row",3,"scrolled"],["class","col-6 col-md-2",3,"game",4,"ngFor","ngForOf"],["class","d-flex justify-content-center",4,"ngIf"],[1,"col-6","col-md-2",3,"game"]],template:function(r,i){if(1&r&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,L,2,1,"h1",2),t.qZA(),t.TgZ(3,"div",3)(4,"button",4),t.NdJ("click",function(){return i.openImportDialog()}),t._uU(5,"Import game from IGDB"),t.qZA()()(),t.YNc(6,M,11,1,"form",5),t.YNc(7,Y,5,0,"ng-container",6),t.YNc(8,B,3,2,"ng-template",null,7,t.W1O)),2&r){const u=t.MAs(9);t.xp6(2),t.Q6J("ngIf",i.gamesCount),t.xp6(4),t.Q6J("ngIf",i.form),t.xp6(1),t.Q6J("ngIf",i.loading)("ngIfElse",u)}},encapsulation:2}),a})()},8636:(N,x,c)=>{c.d(x,{F:()=>a});var t=c(3818),e=c(5e3),_=c(9743),b=c(263),S=c(7961),I=c(9808),d=c(7423),w=c(7771),p=c(5245);const f=function(s){return{"background-color":s}};function E(s,r){if(1&s&&(e.TgZ(0,"button",13),e._uU(1),e._UZ(2,"i",14),e.qZA()),2&s){const i=e.oxw();e.Q6J("ngStyle",e.VKq(2,f,i.game.cover?i.game.cover.colorPalette.backgroundColorHex:"black")),e.xp6(1),e.hij(" ",i.game.countUsers," ")}}function U(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"button",16),e.NdJ("click",function(){e.CHM(i);const C=e.oxw(2);return e.KtG(C.addToList(C.game))}),e.TgZ(1,"mat-icon"),e._uU(2,"add"),e.qZA()()}if(2&s){const i=e.oxw(2);e.Q6J("ngStyle",e.VKq(1,f,i.game.cover?i.game.cover.colorPalette.backgroundColorHex:"black"))}}function H(s,r){if(1&s){const i=e.EpF();e.TgZ(0,"button",16),e.NdJ("click",function(){e.CHM(i);const C=e.oxw(2);return e.KtG(C.removeFromList(C.game))}),e.TgZ(1,"mat-icon"),e._uU(2,"remove"),e.qZA()()}if(2&s){const i=e.oxw(2);e.Q6J("ngStyle",e.VKq(1,f,i.game.cover?i.game.cover.colorPalette.backgroundColorHex:"black"))}}function K(s,r){if(1&s&&(e.ynx(0),e.YNc(1,U,3,3,"button",15),e.YNc(2,H,3,3,"button",15),e.BQk()),2&s){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",!1===i.game.selectedByUser),e.xp6(1),e.Q6J("ngIf",!0===i.game.selectedByUser)}}function W(s,r){1&s&&e._UZ(0,"div",17)}function F(s,r){if(1&s&&(e.ynx(0),e._uU(1),e.BQk()),2&s){const i=e.oxw(2);e.xp6(1),e.Oqu(i.game.platforms[0].name)}}function Z(s,r){1&s&&(e.ynx(0),e._uU(1,", "),e.BQk())}function L(s,r){if(1&s&&(e.ynx(0),e._uU(1),e.YNc(2,Z,2,0,"ng-container",8),e.BQk()),2&s){const i=r.$implicit,u=r.last,C=r.last;e.xp6(1),e.hij(" ",i.abbreviation,""),e.xp6(1),e.Q6J("ngIf",!u&&!C)}}function M(s,r){if(1&s&&(e.ynx(0),e.YNc(1,L,3,2,"ng-container",19),e.BQk()),2&s){const i=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",i.game.platforms)}}function Y(s,r){if(1&s&&(e.TgZ(0,"small",18),e._uU(1," \u2022 "),e.YNc(2,F,2,1,"ng-container",8),e.YNc(3,M,2,1,"ng-container",8),e.qZA()),2&s){const i=e.oxw();e.xp6(2),e.Q6J("ngIf",1===(null==i.game.platforms?null:i.game.platforms.length)),e.xp6(1),e.Q6J("ngIf",(null==i.game.platforms?null:i.game.platforms.length)>1&&11===i.game.category)}}const O=function(s){return["/admin/games/",s]},G=function(){return[]},B=function(s){return{"d-none":s}},J=function(s){return{"has-admin-pill":s}};let a=(()=>{class s{constructor(i,u,C){this.gameHttpService=i,this.authService=u,this.parentComponent=C,this.isAdminSearchComponent=!0,this.hidden=!0,this.isAdmin=!1}ngOnInit(){this.isAdminSearchComponent=this.parentComponent instanceof t.X,this.isAdmin=this.authService.isAdmin}addToList(i){this.gameHttpService.addToList(i.slug).subscribe(()=>{i.selectedByUser=!i.selectedByUser})}removeFromList(i){this.gameHttpService.removeFromList(i.slug).subscribe(()=>{i.selectedByUser=!i.selectedByUser})}}return s.\u0275fac=function(i){return new(i||s)(e.Y36(_.q),e.Y36(b.e),e.Y36(S.X,8))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-game-item"]],inputs:{game:"game"},decls:16,vars:32,consts:[[2,"position","relative","aspect-ratio","3/4","display","flex","align-items","center"],[3,"routerLink"],[1,"card-img-top",2,"flex","0",3,"src","ngClass","alt","load"],[1,"w-100","h-100",2,"position","absolute","top","0","z-index","-1","filter","brightness(50%)",3,"ngStyle","routerLink"],[1,"pills-container",3,"ngClass"],["class","pill countUsers","mat-raised-button","",3,"ngStyle",4,"ngIf"],["mat-raised-button","",1,"pill","countMusics",3,"ngStyle"],[1,"fa-solid","fa-music"],[4,"ngIf"],[1,"card-title","orange"],["class","played",4,"ngIf"],[1,"text-white",3,"routerLink"],["class","ms-1 text-muted","style","font-size: 11px",4,"ngIf"],["mat-raised-button","",1,"pill","countUsers",3,"ngStyle"],[1,"fa-solid","fa-gamepad"],["class","game-item-cta","mat-mini-fab","","aria-label","Example icon button with a heart icon",3,"ngStyle","click",4,"ngIf"],["mat-mini-fab","","aria-label","Example icon button with a heart icon",1,"game-item-cta",3,"ngStyle","click"],[1,"played"],[1,"ms-1","text-muted",2,"font-size","11px"],[4,"ngFor","ngForOf"]],template:function(i,u){1&i&&(e.TgZ(0,"div",0)(1,"a",1)(2,"img",2),e.NdJ("load",function(){return u.hidden=!1}),e.qZA()(),e._UZ(3,"div",3),e.TgZ(4,"div",4),e.YNc(5,E,3,4,"button",5),e.TgZ(6,"button",6),e._uU(7),e._UZ(8,"i",7),e.qZA()(),e.YNc(9,K,3,2,"ng-container",8),e.qZA(),e.TgZ(10,"div",9),e.YNc(11,W,1,0,"div",10),e.TgZ(12,"p")(13,"a",11),e._uU(14),e.qZA(),e.YNc(15,Y,4,2,"small",12),e.qZA()()),2&i&&(e.xp6(1),e.Q6J("routerLink",u.isAdmin?e.VKq(15,O,u.game.slug):e.DdM(17,G)),e.xp6(1),e.Q6J("src",null!=u.game.cover&&u.game.cover.imageId?"https://images.igdb.com/igdb/image/upload/t_720p/"+u.game.cover.imageId+".jpg":"assets/imgs/missing picture.png",e.LSH)("ngClass",e.VKq(18,B,u.hidden))("alt",u.game.name),e.xp6(1),e.Q6J("ngStyle",e.VKq(20,f,u.game.cover?u.game.cover.colorPalette.backgroundColorHex:"black"))("routerLink",u.isAdmin?e.VKq(22,O,u.game.slug):e.DdM(24,G)),e.xp6(1),e.Q6J("ngClass",e.VKq(25,J,u.isAdminSearchComponent)),e.xp6(1),e.Q6J("ngIf",u.isAdminSearchComponent),e.xp6(1),e.Q6J("ngStyle",e.VKq(27,f,u.game.cover?u.game.cover.colorPalette.backgroundColorHex:"black")),e.xp6(1),e.hij(" ",u.game.countMusics," "),e.xp6(2),e.Q6J("ngIf",!1===u.isAdminSearchComponent),e.xp6(2),e.Q6J("ngIf",u.game.selectedByUser),e.xp6(2),e.Q6J("routerLink",u.isAdmin?e.VKq(29,O,u.game.slug):e.DdM(31,G)),e.xp6(1),e.Oqu(u.game.name),e.xp6(1),e.Q6J("ngIf",1===(null==u.game.platforms?null:u.game.platforms.length)||(null==u.game.platforms?null:u.game.platforms.length)>1&&11===u.game.category))},dependencies:[I.mk,I.sg,I.O5,I.PC,d.lW,w.rH,w.yS,p.Hw],encapsulation:2}),s})()},7961:(N,x,c)=>{c.d(x,{X:()=>t});class t{}},9685:(N,x,c)=>{c.d(x,{Ry:()=>ut,Rq:()=>pt});var t=c(5e3),e=c(9646),_=c(4968),b=c(5577),S=c(4004),I=c(8505),d=c(9300),w=c(4986),p=c(4482),f=c(5403),E=c(8421);const U={leading:!0,trailing:!1};var K=c(5963);function Z(n,o,l,m){const g=window&&!!window.document&&window.document.documentElement;let h=g&&o?window:l;if(n&&(h=n&&g&&"string"==typeof n?function L(n,o,l){return(l?window.document:o).querySelector(n)}(n,l.nativeElement,m):n,!h))throw new Error("ngx-infinite-scroll {resolveContainerElement()}: selector for");return h}function M(n){return n&&!n.firstChange}const O={clientHeight:"clientHeight",offsetHeight:"offsetHeight",scrollHeight:"scrollHeight",pageYOffset:"pageYOffset",offsetTop:"offsetTop",scrollTop:"scrollTop",top:"top"},G={clientHeight:"clientWidth",offsetHeight:"offsetWidth",scrollHeight:"scrollWidth",pageYOffset:"pageXOffset",offsetTop:"offsetLeft",scrollTop:"scrollLeft",top:"left"};class B{constructor(o=!0){this.vertical=o,this.propsMap=o?O:G}clientHeightKey(){return this.propsMap.clientHeight}offsetHeightKey(){return this.propsMap.offsetHeight}scrollHeightKey(){return this.propsMap.scrollHeight}pageYOffsetKey(){return this.propsMap.pageYOffset}offsetTopKey(){return this.propsMap.offsetTop}scrollTopKey(){return this.propsMap.scrollTop}topKey(){return this.propsMap.top}}function r(n){return["Window","global"].some(l=>Object.prototype.toString.call(n).includes(l))}function i(n,o){return n?o.document.documentElement:null}function u(n,o){const l=function X({container:n,isWindow:o,axis:l}){const{offsetHeightKey:m,clientHeightKey:g}=$(l);return k(n,o,m,g)}(o);return o.isWindow?function C(n,o,l){const{axis:m,container:g,isWindow:h}=l,{offsetHeightKey:v,clientHeightKey:D}=$(m),T=n+q(i(h,g),m,h),y=k(o.nativeElement,h,v,D),A=function tt(n,o,l){const m=o.topKey();if(n.getBoundingClientRect)return n.getBoundingClientRect()[m]+q(n,o,l)}(o.nativeElement,m,h)+y;return{height:n,scrolled:T,totalToScroll:A,isWindow:h}}(l,n,o):function V(n,o,l){const{axis:m,container:g}=l;return{height:n,scrolled:g[m.scrollTopKey()],totalToScroll:g[m.scrollHeightKey()],isWindow:!1}}(l,0,o)}function $(n){return{offsetHeightKey:n.offsetHeightKey(),clientHeightKey:n.clientHeightKey()}}function k(n,o,l,m){if(isNaN(n[l])){const g=i(o,n);return g?g[m]:0}return n[l]}function q(n,o,l){const m=o.pageYOffsetKey(),g=o.scrollTopKey(),h=o.offsetTopKey();return isNaN(window.pageYOffset)?i(l,n)[g]:n.ownerDocument?n.ownerDocument.defaultView[m]:n[h]}function et(n,o={down:0,up:0},l){let m,g;if(n.totalToScroll<=0)return!1;const h=n.isWindow?n.scrolled:n.height+n.scrolled;return l?(m=(n.totalToScroll-h)/n.totalToScroll,g=(null!=o&&o.down?o.down:0)/10):(m=n.scrolled/(n.scrolled+(n.totalToScroll-h)),g=(null!=o&&o.up?o.up:0)/10),m<=g}class lt{constructor({totalToScroll:o}){this.lastScrollPosition=0,this.lastTotalToScroll=0,this.totalToScroll=0,this.triggered={down:0,up:0},this.totalToScroll=o}updateScrollPosition(o){return this.lastScrollPosition=o}updateTotalToScroll(o){this.lastTotalToScroll!==o&&(this.lastTotalToScroll=this.totalToScroll,this.totalToScroll=o)}updateScroll(o,l){this.updateScrollPosition(o),this.updateTotalToScroll(l)}updateTriggeredFlag(o,l){l?this.triggered.down=o:this.triggered.up=o}isTriggeredScroll(o,l){return l?this.triggered.down===o:this.triggered.up===o}}function st(n){const{scrollContainer:o,scrollWindow:l,element:m,fromRoot:g}=n,h=function a({windowElement:n,axis:o}){return function s(n,o){const l=n.isWindow||o&&!o.nativeElement?o:o.nativeElement;return Object.assign(Object.assign({},n),{container:l})}({axis:o,isWindow:r(n)},n)}({axis:new B(!n.horizontal),windowElement:Z(o,l,m,g)}),v=new lt({totalToScroll:u(m,h)}),T={up:n.upDistance,down:n.downDistance};return function at(n){let o=(0,_.R)(n.container,"scroll");return n.throttle&&(o=o.pipe(function W(n,o=w.z,l=U){const m=(0,K.H)(n,o);return function H(n,o=U){return(0,p.e)((l,m)=>{const{leading:g,trailing:h}=o;let v=!1,D=null,T=null,y=!1;const A=()=>{null==T||T.unsubscribe(),T=null,h&&(z(),y&&m.complete())},R=()=>{T=null,y&&m.complete()},j=P=>T=(0,E.Xf)(n(P)).subscribe((0,f.x)(m,A,R)),z=()=>{if(v){v=!1;const P=D;D=null,m.next(P),!y&&j(P)}};l.subscribe((0,f.x)(m,P=>{v=!0,D=P,(!T||T.closed)&&(g?z():j(P))},()=>{y=!0,(!(h&&v&&T)||T.closed)&&m.complete()}))})}(()=>m,l)}(n.throttle,void 0,{leading:!0,trailing:!0}))),o}({container:h.container,throttle:n.throttle}).pipe((0,b.z)(()=>(0,e.of)(u(m,h))),(0,S.U)(y=>function ct(n,o,l){const{scrollDown:m,fire:g}=function ot(n,o,l){const m=function nt(n,o){return n<o.scrolled}(n,o);return{fire:et(o,l,m),scrollDown:m}}(n,o,l);return{scrollDown:m,fire:g,stats:o}}(v.lastScrollPosition,y,T)),(0,I.b)(({stats:y})=>v.updateScroll(y.scrolled,y.totalToScroll)),(0,d.h)(({fire:y,scrollDown:A,stats:{totalToScroll:R}})=>function J(n,o,l){return!!(n&&o||!l&&o)}(n.alwaysCallback,y,v.isTriggeredScroll(R,A))),(0,I.b)(({scrollDown:y,stats:{totalToScroll:A}})=>{v.updateTriggeredFlag(A,y)}),(0,S.U)(mt))}function mt(n){const{scrollDown:o,stats:{scrolled:l}}=n;return{type:o?"[NGX_ISE] DOWN":"[NGX_ISE] UP",payload:{currentScrollPosition:l}}}let ut=(()=>{class n{constructor(l,m){this.element=l,this.zone=m,this.scrolled=new t.vpe,this.scrolledUp=new t.vpe,this.infiniteScrollDistance=2,this.infiniteScrollUpDistance=1.5,this.infiniteScrollThrottle=150,this.infiniteScrollDisabled=!1,this.infiniteScrollContainer=null,this.scrollWindow=!0,this.immediateCheck=!1,this.horizontal=!1,this.alwaysCallback=!1,this.fromRoot=!1}ngAfterViewInit(){this.infiniteScrollDisabled||this.setup()}ngOnChanges({infiniteScrollContainer:l,infiniteScrollDisabled:m,infiniteScrollDistance:g}){const h=M(l),v=M(m),D=M(g),T=!v&&!this.infiniteScrollDisabled||v&&!m.currentValue||D;(h||v||D)&&(this.destroyScroller(),T&&this.setup())}setup(){(function Y(){return"undefined"!=typeof window})()&&this.zone.runOutsideAngular(()=>{this.disposeScroller=st({fromRoot:this.fromRoot,alwaysCallback:this.alwaysCallback,disable:this.infiniteScrollDisabled,downDistance:this.infiniteScrollDistance,element:this.element,horizontal:this.horizontal,scrollContainer:this.infiniteScrollContainer,scrollWindow:this.scrollWindow,throttle:this.infiniteScrollThrottle,upDistance:this.infiniteScrollUpDistance}).subscribe(l=>this.zone.run(()=>this.handleOnScroll(l)))})}handleOnScroll({type:l,payload:m}){switch(l){case"[NGX_ISE] DOWN":return this.scrolled.emit(m);case"[NGX_ISE] UP":return this.scrolledUp.emit(m);default:return}}ngOnDestroy(){this.destroyScroller()}destroyScroller(){this.disposeScroller&&this.disposeScroller.unsubscribe()}}return n.\u0275fac=function(l){return new(l||n)(t.Y36(t.SBq),t.Y36(t.R0b))},n.\u0275dir=t.lG2({type:n,selectors:[["","infiniteScroll",""],["","infinite-scroll",""],["","data-infinite-scroll",""]],inputs:{infiniteScrollDistance:"infiniteScrollDistance",infiniteScrollUpDistance:"infiniteScrollUpDistance",infiniteScrollThrottle:"infiniteScrollThrottle",infiniteScrollDisabled:"infiniteScrollDisabled",infiniteScrollContainer:"infiniteScrollContainer",scrollWindow:"scrollWindow",immediateCheck:"immediateCheck",horizontal:"horizontal",alwaysCallback:"alwaysCallback",fromRoot:"fromRoot"},outputs:{scrolled:"scrolled",scrolledUp:"scrolledUp"},features:[t.TTD]}),n})(),pt=(()=>{class n{}return n.\u0275fac=function(l){return new(l||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({}),n})()}}]);