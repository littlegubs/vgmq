(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{g7DB:function(e,i,t){"use strict";t.r(i),t.d(i,"LoginModule",(function(){return N}));var s=t("ofXK"),r=t("tyNb"),o=t("3Pt+"),c=t("nYR2"),n=t("AytR"),b=t("fXoL"),d=t("ZEaD"),a=t("b6Qw");function l(e,i){if(1&e&&(b.Ob(0,"div",22),b.yc(1),b.Nb()),2&e){const e=b.Zb();b.zb(1),b.Ac(" ",e.formErrorMessage," ")}}function m(e,i){1&e&&b.Kb(0,"span",23)}function u(e,i){1&e&&b.Kb(0,"span",23)}function g(e,i){if(1&e&&(b.Ob(0,"div",31),b.yc(1),b.Nb()),2&e){const e=b.Zb(2);b.zb(1),b.Ac(" ",e.limitedAccessError," ")}}const p=function(e){return{"is-invalid":e}};function f(e,i){if(1&e){const e=b.Pb();b.Ob(0,"div",24),b.Ob(1,"form",25),b.Vb("ngSubmit",(function(){b.nc(e);const i=b.Zb();return i.limitedAccessLoading||i.testLimitedAccessPassword()})),b.Ob(2,"label"),b.yc(3,"This website is a work in progress, to create an account and get a limited access, please enter the magic password below"),b.Nb(),b.Ob(4,"div",26),b.Kb(5,"input",27),b.Ob(6,"div",28),b.Ob(7,"button",29),b.yc(8," Enter"),b.wc(9,u,1,0,"span",16),b.Nb(),b.Nb(),b.Nb(),b.wc(10,g,2,1,"div",30),b.Nb(),b.Nb()}if(2&e){const e=b.Zb();b.zb(1),b.gc("formGroup",e.limitedAccessForm),b.zb(3),b.gc("ngClass",b.jc(6,p,e.limitedAccessError)),b.zb(1),b.gc("ngClass",b.jc(8,p,e.limitedAccessError)),b.zb(2),b.gc("disabled",e.limitedAccessLoading),b.zb(2),b.gc("ngIf",e.limitedAccessLoading),b.zb(1),b.gc("ngIf",e.limitedAccessError)}}const h=function(e){return{disabled:e}};let w=(()=>{class e{constructor(e,i,t,s){this.fb=e,this.router=i,this.authHttpService=t,this.cookieService=s,this.loading=!1,this.limitedAccessLoading=!1,this.limitedAccessAllowed=!0,this.loginForm=this.fb.group({username:["",o.s.required.bind(this)],password:["",o.s.required.bind(this)]}),this.limitedAccessForm=this.fb.group({password:["",o.s.required.bind(this)]}),this.setLimitedAccessAllowed()}loginUser(){this.loading=!0,this.authHttpService.login(this.loginForm.value).pipe(Object(c.a)(()=>this.loading=!1)).subscribe(e=>{if(null!==e&&!n.a.production){const i=e.token.split(".");this.cookieService.set("vgmq-ut-hp",`${i[0]}.${i[1]}`),this.cookieService.set("vgmq-ut-s",i[2])}this.router.navigate([""])},e=>{this.formErrorMessage=e.message,this.loginForm.get("password").setValue("")})}testLimitedAccessPassword(){this.limitedAccessLoading=!0,this.limitedAccessError=void 0,this.authHttpService.limitedAccessPassword(this.limitedAccessForm.get("password").value).pipe(Object(c.a)(()=>this.limitedAccessLoading=!1)).subscribe(()=>{this.setLimitedAccessAllowed()},e=>{this.limitedAccessError=e.error})}setLimitedAccessAllowed(){this.authHttpService.limitedAccessAllowed().subscribe(e=>{this.limitedAccessAllowed=e})}}return e.\u0275fac=function(i){return new(i||e)(b.Jb(o.c),b.Jb(r.b),b.Jb(d.a),b.Jb(a.a))},e.\u0275cmp=b.Db({type:e,selectors:[["app-login"]],decls:38,vars:8,consts:[[1,"container"],[1,"h1","font-weight-normal","text-center"],[1,"h4","font-weight-normal","text-center"],[1,"row","align-items-center"],[1,"col-md-6"],[1,"form-login",3,"formGroup","ngSubmit"],["class","col-md-12 alert alert-danger","role","alert",4,"ngIf"],[1,"form-group"],["type","email","formControlName","username","placeholder","username","required","",1,"form-control"],["type","password","formControlName","password","placeholder","Password",1,"form-control"],[1,"row","pt-2"],[1,"form-check"],["type","checkbox","id","checkRemember",1,"form-check-input"],["for","checkRemember",1,"form-check-label"],[1,"col-md-12","text-center"],["type","submit",1,"btn","btn-primary","col-md-6",3,"disabled"],["class","spinner-border spinner-border-sm","role","status","aria-hidden","true",4,"ngIf"],[1,"col-md-6","text-center"],[1,"orange"],[1,"col-md-12"],["routerLink","/register",1,"btn","btn-primary","col-md-6",3,"ngClass"],["class","col-md-12 mt-5",4,"ngIf"],["role","alert",1,"col-md-12","alert","alert-danger"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],[1,"col-md-12","mt-5"],[3,"formGroup","ngSubmit"],[1,"input-group",3,"ngClass"],["type","password","placeholder","Limited password","aria-label","Limited password","aria-describedby","button-addon2","formControlName","password",1,"form-control",3,"ngClass"],[1,"input-group-append"],["type","submit","id","button-addon2",1,"btn","btn-primary",3,"disabled"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback"]],template:function(e,i){1&e&&(b.Ob(0,"div",0),b.Ob(1,"h1",1),b.yc(2,"VGMQ"),b.Nb(),b.Ob(3,"h4",2),b.yc(4,"Video Game Music Quiz"),b.Nb(),b.Ob(5,"div",3),b.Ob(6,"div",4),b.Ob(7,"form",5),b.Vb("ngSubmit",(function(){return i.loading||i.loginUser()})),b.wc(8,l,2,1,"div",6),b.Ob(9,"div",7),b.Ob(10,"label"),b.yc(11,"Username"),b.Nb(),b.Kb(12,"input",8),b.Nb(),b.Ob(13,"div",7),b.Ob(14,"label"),b.yc(15,"Password"),b.Nb(),b.Kb(16,"input",9),b.Nb(),b.Ob(17,"div",10),b.Ob(18,"div",4),b.Ob(19,"div",11),b.Kb(20,"input",12),b.Ob(21,"label",13),b.yc(22,"Remember me"),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Ob(23,"div",14),b.Ob(24,"button",15),b.wc(25,m,1,0,"span",16),b.yc(26," Log in "),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Ob(27,"div",17),b.Ob(28,"div",7),b.Ob(29,"label"),b.yc(30,"No "),b.Ob(31,"span",18),b.yc(32,"account"),b.Nb(),b.yc(33," ?"),b.Nb(),b.Ob(34,"div",19),b.Ob(35,"a",20),b.yc(36,"Register now"),b.Nb(),b.Nb(),b.wc(37,f,11,10,"div",21),b.Nb(),b.Nb(),b.Nb(),b.Nb()),2&e&&(b.zb(7),b.gc("formGroup",i.loginForm),b.zb(1),b.gc("ngIf",i.formErrorMessage),b.zb(16),b.gc("disabled",i.loading),b.zb(1),b.gc("ngIf",i.loading),b.zb(10),b.gc("ngClass",b.jc(6,h,!i.limitedAccessAllowed)),b.zb(2),b.gc("ngIf",!i.limitedAccessAllowed))},directives:[o.t,o.n,o.h,s.l,o.b,o.m,o.f,o.r,r.e,s.j],encapsulation:2}),e})();var v=t("PCNd");const A=[{path:"",component:w}];let N=(()=>{class e{}return e.\u0275mod=b.Hb({type:e}),e.\u0275inj=b.Gb({factory:function(i){return new(i||e)},imports:[[s.c,v.a,r.f.forChild(A)]]}),e})()}}]);